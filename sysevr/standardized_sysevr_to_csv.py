## desperate code, takes much shorter time, had no choice
from sysevr import preprocess_sysevr as psvr
import pandas as pd

path = "D:\\lenovo\\Desktop\\2018280142\\Preprocess\\data\\sysevr\\all_sysevr.csv"
sysevr_df = pd.read_csv(path)

code = sysevr_df["code"].to_list()
labels = sysevr_df["label"].to_list()
print(len(code))

all_arr = []
all_labels = []
# a=0

# for i in range(0, 217535):
#     if i % 5000 == 0:
#         a +=5000
#         numbers.append(a)
#
# for i in range(0, len(numbers)):
#     if i==0:
#         print(str(0)+":"+str(numbers[i]))
#
#     if numbers[i] < numbers[i+1]:
#         print(str(numbers[i])+":"+str(numbers[i+1]))

a1 = code[0:5000]
a2 = code[5000:10000]
a3 = code[10000:15000]
a4 = code[15000:20000]
a5 = code[20000:25000]
a6 = code[25000:30000]
a7 = code[30000:35000]
a8 = code[35000:40000]
a9 = code[40000:45000]
a10 = code[45000:50000]
a11 = code[50000:55000]
a12 = code[55000:60000]
a13 = code[60000:65000]
a14 = code[65000:70000]
a15 = code[70000:75000]
a16 = code[75000:80000]
a17 = code[80000:85000]
a18 = code[85000:90000]
a19 = code[90000:95000]
a20 = code[95000:100000]
a21 = code[100000:105000]
a22 = code[105000:110000]
a23 = code[110000:115000]
a24 = code[115000:120000]
a25 = code[120000:125000]
a26 = code[125000:130000]
a27 = code[130000:135000]
a28 = code[135000:140000]
a29 = code[140000:145000]
a30 = code[145000:150000]
a31 = code[150000:155000]
a32 = code[155000:160000]
a33 = code[160000:165000]
a34 = code[165000:170000]
a35 = code[170000:175000]
a36 = code[175000:180000]
a37 = code[180000:185000]
a38 = code[185000:190000]
a39 = code[190000:195000]
a40 = code[195000:200000]
a41 = code[200000:205000]
a42 = code[205000:210000]
a43 = code[210000:215000]
a44 = code[215000:]

lab_ar1 = labels[0:5000]
lab_ar2 = labels[5000:10000]
lab_ar3 = labels[10000:15000]
lab_ar4 = labels[15000:20000]
lab_ar5 = labels[20000:25000]
lab_ar6 = labels[25000:30000]
lab_ar7 = labels[30000:35000]
lab_ar8 = labels[35000:40000]
lab_ar9 = labels[40000:45000]
lab_ar10 = labels[45000:50000]
lab_ar11 = labels[50000:55000]
lab_ar12 = labels[55000:60000]
lab_ar13 = labels[60000:65000]
lab_ar14 = labels[65000:70000]
lab_ar15 = labels[70000:75000]
lab_ar16 = labels[75000:80000]
lab_ar17 = labels[80000:85000]
lab_ar18 = labels[85000:90000]
lab_ar19 = labels[90000:95000]
lab_ar20 = labels[95000:100000]
lab_ar21 = labels[100000:105000]
lab_ar22 = labels[105000:110000]
lab_ar23 = labels[110000:115000]
lab_ar24 = labels[115000:120000]
lab_ar25 = labels[120000:125000]
lab_ar26 = labels[125000:130000]
lab_ar27 = labels[130000:135000]
lab_ar28 = labels[135000:140000]
lab_ar29 = labels[140000:145000]
lab_ar30 = labels[145000:150000]
lab_ar31 = labels[150000:155000]
lab_ar32 = labels[155000:160000]
lab_ar33 = labels[160000:165000]
lab_ar34 = labels[165000:170000]
lab_ar35 = labels[170000:175000]
lab_ar36 = labels[175000:180000]
lab_ar37 = labels[180000:185000]
lab_ar38 = labels[185000:190000]
lab_ar39 = labels[190000:195000]
lab_ar40 = labels[195000:200000]
lab_ar41 = labels[200000:205000]
lab_ar42 = labels[205000:210000]
lab_ar43 = labels[210000:215000]
lab_ar44 = labels[215000:]

all_arr.append(a1)
all_arr.append(a2)
all_arr.append(a3)
all_arr.append(a4)
all_arr.append(a5)
all_arr.append(a6)
all_arr.append(a7)
all_arr.append(a8)
all_arr.append(a9)
all_arr.append(a10)
all_arr.append(a11)
all_arr.append(a12)
all_arr.append(a13)
all_arr.append(a14)
all_arr.append(a15)
all_arr.append(a16)
all_arr.append(a17)
all_arr.append(a18)
all_arr.append(a19)
all_arr.append(a20)
all_arr.append(a21)
all_arr.append(a22)
all_arr.append(a23)
all_arr.append(a24)
all_arr.append(a25)
all_arr.append(a26)
all_arr.append(a27)
all_arr.append(a28)
all_arr.append(a29)
all_arr.append(a30)
all_arr.append(a31)
all_arr.append(a32)
all_arr.append(a33)
all_arr.append(a34)
all_arr.append(a35)
all_arr.append(a36)
all_arr.append(a37)
all_arr.append(a38)
all_arr.append(a39)
all_arr.append(a40)
all_arr.append(a41)
all_arr.append(a42)
all_arr.append(a43)
all_arr.append(a44)

all_labels.append(lab_ar1)
all_labels.append(lab_ar2)
all_labels.append(lab_ar3)
all_labels.append(lab_ar4)
all_labels.append(lab_ar5)
all_labels.append(lab_ar6)
all_labels.append(lab_ar7)
all_labels.append(lab_ar8)
all_labels.append(lab_ar9)
all_labels.append(lab_ar10)
all_labels.append(lab_ar11)
all_labels.append(lab_ar12)
all_labels.append(lab_ar13)
all_labels.append(lab_ar14)
all_labels.append(lab_ar15)
all_labels.append(lab_ar16)
all_labels.append(lab_ar17)
all_labels.append(lab_ar18)
all_labels.append(lab_ar19)
all_labels.append(lab_ar20)
all_labels.append(lab_ar21)
all_labels.append(lab_ar22)
all_labels.append(lab_ar23)
all_labels.append(lab_ar24)
all_labels.append(lab_ar25)
all_labels.append(lab_ar26)
all_labels.append(lab_ar27)
all_labels.append(lab_ar28)
all_labels.append(lab_ar29)
all_labels.append(lab_ar30)
all_labels.append(lab_ar31)
all_labels.append(lab_ar32)
all_labels.append(lab_ar33)
all_labels.append(lab_ar34)
all_labels.append(lab_ar35)
all_labels.append(lab_ar36)
all_labels.append(lab_ar37)
all_labels.append(lab_ar38)
all_labels.append(lab_ar39)
all_labels.append(lab_ar40)
all_labels.append(lab_ar41)
all_labels.append(lab_ar42)
all_labels.append(lab_ar43)
all_labels.append(lab_ar44)

# print(a1[0])
# print(lab_ar1[0])
# print("##############################################")
# print(a1[1])
# print(lab_ar1[1])
# print("##############################################")
# print(a1[2])
# print(lab_ar1[2])
# print("##############################################")
# print(a1[4])
# print(lab_ar1[4])

standardzd = []

for i in range(0, len(all_arr)):
    array = all_arr[i]
    labs = all_labels[i]
    csv_arr = []

    print("stage " + str(i))
    dd = psvr.mapping(array)

    for s in range(0, len(dd)):
        ftext = dd[s]
        flabel = labs[s]
        csv_arr.append([ftext, flabel])

    vdf = pd.DataFrame.from_records(csv_arr, columns=['code', 'label'])
    path1 = "D:\\lenovo\\Desktop\\sysevr\\"+str(i)+".csv"

    vdf.to_csv(path1, index=None, header=True)
    print("stage " + str(i) + " done")

    array.clear()
    labs.clear()
    csv_arr.clear()

# dd = psvr.mapping(a1)

# print(dd[0])
# print("#############")
# print(dd[1])