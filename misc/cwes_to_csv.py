from os import walk
import shutil
import pandas as pd

path = "D:\\lenovo\\Desktop\\PointerU\\"

ar1 = []
labels = []
data = ''

c = 0

for (dirpath, dirnames, filenames) in walk(path):
    for file in sorted(filenames):
        f = open(path + file, encoding='utf-8')
        data = f.readlines()[2:]

        last = data[len(data) - 1]
        # print(last)
        ar1.append(data)
        labels.append(last)

gl = len(ar1)
c = 0

text_array = []
text_data = ''

for i in range(0, gl):
    num = len(ar1[i])
    for s in range(0, num - 1):
        text_data += ar1[i][s]
    #         print(ar1[i][s])
    #         text_data += ar1[i][s]
    #         text_array.append(text_data)
    text_array.append(text_data)
    text_data = ''
    #     print("-------------------------------")
    #     print(text_data)
    #     print("-------------------------------------------")
    c += 1

print("total: " + str(c))
#
alldata = []
for i in range(0, len(text_array)):
    ftext = text_array[i].strip()
    flabel = labels[i].strip()
    alldata.append([ftext, flabel])

vdf = pd.DataFrame.from_records(alldata, columns=['code', 'label'])
print(vdf.head(5))

path = "D:\\lenovo\\Desktop\\PointerU_sysevr.csv"
vdf.to_csv(path, index=None, header=True)
